<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.7" pages="4">
  <diagram name="1. Quy trình Danh mục sản phẩm" id="page1">
    <mxGraphModel dx="1246" dy="713" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="swimlane-customer" value="Người mua (Customer)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="40" y="40" width="360" height="560" as="geometry" />
        </mxCell>
        <mxCell id="browse-products" value="Duyệt danh sách sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer" vertex="1">
          <mxGeometry x="100" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="search-filter" value="Tìm kiếm / Lọc / Sắp xếp sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer" vertex="1">
          <mxGeometry x="100" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="view-detail" value="Xem chi tiết sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer" vertex="1">
          <mxGeometry x="100" y="310" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pdMaPdUw1JlCRbC2kpBL-1" value="" style="ellipse;html=1;shape=endState;fillColor=strokeColor;" vertex="1" parent="swimlane-customer">
          <mxGeometry x="165" y="404" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="pdMaPdUw1JlCRbC2kpBL-2" value="" style="ellipse;fillColor=strokeColor;html=1;" vertex="1" parent="swimlane-customer">
          <mxGeometry x="165" y="78" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow12" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;" parent="swimlane-customer" source="view-detail" target="pdMaPdUw1JlCRbC2kpBL-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="200" y="370" as="sourcePoint" />
            <mxPoint x="179.99999999999977" y="490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swimlane-system" value="Hệ thống Website (System)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="400" y="40" width="360" height="560" as="geometry" />
        </mxCell>
        <mxCell id="show-list" value="Hiển thị danh sách sản phẩm (API: GET /)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system" vertex="1">
          <mxGeometry x="100" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="process-search" value="Xử lý tìm kiếm, lọc, phân trang (API: GET /category/pagination)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system" vertex="1">
          <mxGeometry x="100" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="show-detail" value="Hiển thị thông tin chi tiết sản phẩm (API: GET /:id)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system" vertex="1">
          <mxGeometry x="100" y="310" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="product-info" value="Hiển thị: Tên, Mô tả, Giá, Tồn kho, Hình ảnh" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system" vertex="1">
          <mxGeometry x="100" y="400" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="swimlane-admin" value="Quản trị viên (Admin)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="760" y="40" width="360" height="560" as="geometry" />
        </mxCell>
        <mxCell id="admin-manage" value="Quản lý sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin" vertex="1">
          <mxGeometry x="100" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="admin-add" value="Thêm sản phẩm mới" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin" vertex="1">
          <mxGeometry x="100" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="admin-edit" value="Sửa / Xóa sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin" vertex="1">
          <mxGeometry x="100" y="310" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="admin-categorize" value="Phân loại và phân trang sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin" vertex="1">
          <mxGeometry x="100" y="400" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" target="browse-products" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="219.99999999999977" y="139.9999999999999" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="browse-products" target="search-filter" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="browse-products" target="show-list" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="search-filter" target="process-search" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="search-filter" target="view-detail" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow6" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="view-detail" target="show-detail" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow7" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="show-detail" target="product-info" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow9" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="admin-manage" target="admin-add" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow10" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="admin-add" target="admin-edit" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow11" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="admin-edit" target="admin-categorize" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mtkURLR51YFnrMlDs1Uw-1" value="" style="endArrow=classic;html=1;" edge="1" parent="1" source="show-list" target="admin-manage">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="702" y="250" as="sourcePoint" />
            <mxPoint x="902" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="2. Quy trình Giỏ hàng" id="page2">
    <mxGraphModel dx="2048" dy="768" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="swimlane-customer2" value="Người mua (Customer)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="40" y="40" width="400" height="720" as="geometry" />
        </mxCell>
        <mxCell id="browse-products2" value="Xem sản phẩm trong danh mục / chi tiết" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer2" vertex="1">
          <mxGeometry x="120" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="add-to-cart" value="Nhấn &quot;Thêm vào giỏ hàng&quot;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer2" vertex="1">
          <mxGeometry x="120" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="view-cart" value="Xem giỏ hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer2" vertex="1">
          <mxGeometry x="120" y="380" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="decision-delete" value="Xóa sản phẩm?" style="rhombus;whiteSpace=wrap;html=1;" parent="swimlane-customer2" vertex="1">
          <mxGeometry x="140" y="470" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="remove-product" value="Xóa sản phẩm khỏi giỏ" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer2" vertex="1">
          <mxGeometry x="120" y="580" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="stNNj4Suh8GQfRIrMgKi-1" value="" style="ellipse;html=1;shape=endState;fillColor=strokeColor;" vertex="1" parent="swimlane-customer2">
          <mxGeometry x="185" y="665" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-10" value="Không" style="endArrow=classic;html=1;exitX=0;exitY=0.5;" parent="swimlane-customer2" source="decision-delete" target="stNNj4Suh8GQfRIrMgKi-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="40" y="510" />
              <mxPoint x="40" y="680" />
            </Array>
            <mxPoint x="180.00000000000819" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow2-11" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="swimlane-customer2" source="remove-product" target="stNNj4Suh8GQfRIrMgKi-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="200.00000000000023" y="660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="stNNj4Suh8GQfRIrMgKi-2" value="" style="ellipse;fillColor=strokeColor;html=1;" vertex="1" parent="swimlane-customer2">
          <mxGeometry x="185.00000000000023" y="76" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="swimlane-customer2" source="stNNj4Suh8GQfRIrMgKi-2" target="browse-products2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="200.00000000000023" y="100" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swimlane-system2" value="Hệ thống Website (System)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="440" y="40" width="400" height="720" as="geometry" />
        </mxCell>
        <mxCell id="save-to-localstorage" value="Lưu vào localStorage (&quot;carts&quot;)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system2" vertex="1">
          <mxGeometry x="120" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="update-cart-ui" value="Cập nhật Redux state và UI giỏ hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system2" vertex="1">
          <mxGeometry x="120" y="310" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="show-cart-summary" value="Hiển thị tóm tắt giỏ hàng:&lt;div&gt;- Danh sách sản phẩm&lt;br&gt;- Tổng tiền&lt;br&gt;- Phí ship&lt;br&gt;- Khuyến mãi&lt;br&gt;- Tổng đơn hàng&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system2" vertex="1">
          <mxGeometry x="100" y="380" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="update-total" value="Cập nhật lại tổng tiền (Sum_Price function)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system2" vertex="1">
          <mxGeometry x="120" y="580" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-2" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="browse-products2" target="add-to-cart" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-3" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="add-to-cart" target="save-to-localstorage" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-4" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="save-to-localstorage" target="update-cart-ui" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-5" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=0.5;entryY=0;" parent="1" source="update-cart-ui" target="view-cart" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-6" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="view-cart" target="show-cart-summary" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-7" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="view-cart" target="decision-delete" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-8" value="Có" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="decision-delete" target="remove-product" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2-9" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="remove-product" target="update-total" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="3. Quy trình Bán hàng (Đặt hàng + Thanh toán)" id="page3">
    <mxGraphModel dx="2662" dy="998" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="swimlane-customer3" value="Người mua (Customer)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="40" y="40" width="340" height="1300" as="geometry" />
        </mxCell>
        <mxCell id="goto-checkout" value="Vào trang Checkout" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="90" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="enter-info" value="Nhập thông tin:\n- Họ tên\n- Số điện thoại\n- Địa chỉ\n- Email" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="90" y="220" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="choose-payment" value="Chọn phương thức thanh toán" style="rhombus;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="100" y="420" width="140" height="100" as="geometry" />
        </mxCell>
        <mxCell id="paypal-payment" value="Thanh toán qua PayPal" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="20" y="570" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="cod-payment" value="Thanh toán COD (Khi nhận hàng)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="190" y="570" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="confirm-order" value="Xác nhận đặt hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="90" y="760" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="receive-email" value="Nhận email xác nhận đơn hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="90" y="1050" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="track-order" value="Theo dõi tình trạng đơn hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer3" vertex="1">
          <mxGeometry x="90" y="1140" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="6RuFkRc0bBdisA8JPVy1-1" value="" style="ellipse;fillColor=strokeColor;html=1;" vertex="1" parent="swimlane-customer3">
          <mxGeometry x="155" y="61" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-1" value="" style="endArrow=classic;html=1;entryX=0.5;entryY=0;" parent="swimlane-customer3" source="6RuFkRc0bBdisA8JPVy1-1" target="goto-checkout" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="170" y="99.99999999999989" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6RuFkRc0bBdisA8JPVy1-5" value="" style="ellipse;html=1;shape=endState;fillColor=strokeColor;" vertex="1" parent="swimlane-customer3">
          <mxGeometry x="155" y="1241" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-24" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;" parent="swimlane-customer3" source="track-order" target="6RuFkRc0bBdisA8JPVy1-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="170" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swimlane-system3" value="Hệ thống Website (System)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="380" y="40" width="380" height="1300" as="geometry" />
        </mxCell>
        <mxCell id="show-checkout-form" value="Hiển thị form thông tin giao hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="show-address-map" value="Hiển thị bản đồ chọn địa chỉ (Google Maps API)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="calculate-shipping" value="Tính phí vận chuyển dựa trên khoảng cách (MapComponent)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="310" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="validate-info" value="Kiểm tra thông tin hợp lệ (validation)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="420" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="process-paypal" value="Xử lý thanh toán PayPal (Paypal Component)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="30" y="650" width="140" height="70" as="geometry" />
        </mxCell>
        <mxCell id="process-momo" value="Hỗ trợ thanh toán MoMo (MoMo Component)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="210" y="650" width="140" height="70" as="geometry" />
        </mxCell>
        <mxCell id="check-stock" value="Kiểm tra tồn kho sản phẩm" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="760" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="create-order" value="Tạo đơn hàng (API: POST /order)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="850" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="create-detail-order" value="Tạo chi tiết đơn hàng (Detail_Order model)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="940" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="send-email" value="Gửi email xác nhận (API: POST /email, mailer.js)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="1050" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="update-order-db" value="Lưu trạng thái đơn hàng vào DB (MongoDB)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system3" vertex="1">
          <mxGeometry x="110" y="1140" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="swimlane-admin3" value="Quản trị viên (Admin)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="760" y="40" width="360" height="1300" as="geometry" />
        </mxCell>
        <mxCell id="view-orders" value="Xem danh sách đơn hàng (API: GET /order/:id)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin3" vertex="1">
          <mxGeometry x="100" y="850" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="update-order-status" value="Cập nhật trạng thái đơn hàng:&lt;div&gt;- Đang xử lý&lt;/div&gt;&lt;div&gt;- Đang giao&amp;nbsp;&lt;/div&gt;&lt;div&gt;- Đã giao&lt;/div&gt;&lt;div&gt;- Hủy&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin3" vertex="1">
          <mxGeometry x="92" y="940" width="176" height="100" as="geometry" />
        </mxCell>
        <mxCell id="manage-delivery" value="Quản lý giao hàng (Delivery model)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin3" vertex="1">
          <mxGeometry x="100" y="1070" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="track-status" value="Theo dõi trạng thái giao hàng" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-admin3" vertex="1">
          <mxGeometry x="100" y="1160" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-2" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="goto-checkout" target="show-checkout-form" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-3" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="goto-checkout" target="enter-info" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-4" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="enter-info" target="show-address-map" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-5" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="show-address-map" target="calculate-shipping" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-6" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=0.5;entryY=0;" parent="1" source="calculate-shipping" target="choose-payment" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-7" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="choose-payment" target="validate-info" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-8" value="PayPal" style="endArrow=classic;html=1;exitX=0;exitY=1;entryX=0.5;entryY=0;" parent="1" source="choose-payment" target="paypal-payment" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-9" value="COD / MoMo" style="endArrow=classic;html=1;exitX=1;exitY=1;entryX=0.5;entryY=0;" parent="1" source="choose-payment" target="cod-payment" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-10" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0;entryY=0.5;" parent="1" source="paypal-payment" target="process-paypal" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-11" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="cod-payment" target="process-momo" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-12" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="process-paypal" target="confirm-order" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-13" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;" parent="1" source="process-momo" target="confirm-order" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="330" y="799" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow3-14" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="confirm-order" target="check-stock" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-15" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="check-stock" target="create-order" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-17" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="create-order" target="create-detail-order" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-18" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="create-detail-order" target="send-email" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-19" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;" parent="1" source="send-email" target="receive-email" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-20" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="send-email" target="update-order-db" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-22" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;" parent="1" source="track-status" target="track-order" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="559" y="1277" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow3-23" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="receive-email" target="track-order" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-25" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="view-orders" target="update-order-status" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-26" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="update-order-status" target="manage-delivery" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-27" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="manage-delivery" target="track-status" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6RuFkRc0bBdisA8JPVy1-3" value="" style="endArrow=classic;html=1;" edge="1" parent="1" source="update-order-db" target="track-status">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="950" y="1159" as="sourcePoint" />
            <mxPoint x="750" y="1159" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6RuFkRc0bBdisA8JPVy1-4" value="" style="endArrow=classic;html=1;" edge="1" parent="1" source="create-order" target="view-orders">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="697" y="942" as="sourcePoint" />
            <mxPoint x="907" y="954" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="4. Quy trình Xác nhận Email" id="page4">
    <mxGraphModel dx="1901" dy="713" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="swimlane-customer4" value="Người mua (Customer)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="40" y="40" width="360" height="720" as="geometry" />
        </mxCell>
        <mxCell id="receive-email-cus" value="Nhận email trong hộp thư" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer4" vertex="1">
          <mxGeometry x="100" y="300" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="view-email" value="Xem thông tin đơn hàng:&lt;div&gt;- Danh sách sản phẩm&lt;/div&gt;&lt;div&gt;- Mã đơn hàng&lt;/div&gt;&lt;div&gt;- Địa chỉ giao hàng&lt;/div&gt;&lt;div&gt;- Phương thức thanh toán&lt;/div&gt;&lt;div&gt;- Tổng tiền&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer4" vertex="1">
          <mxGeometry x="90" y="410" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="track-via-email" value="Theo dõi tình trạng đơn hàng qua email" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-customer4" vertex="1">
          <mxGeometry x="100" y="570" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wKqHdRLLKflESSqN6Z4U-1" value="" style="ellipse;html=1;shape=endState;fillColor=strokeColor;" vertex="1" parent="swimlane-customer4">
          <mxGeometry x="165" y="670" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-10" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;" parent="swimlane-customer4" source="track-via-email" target="wKqHdRLLKflESSqN6Z4U-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="179.99999999999977" y="660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swimlane-system4" value="Hệ thống Website (System)" style="swimlane;startSize=40;" parent="1" vertex="1">
          <mxGeometry x="400" y="40" width="400" height="720" as="geometry" />
        </mxCell>
        <mxCell id="order-confirmed" value="Đơn hàng được xác nhận thành công" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system4" vertex="1">
          <mxGeometry x="120" y="130" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="get-cart-details" value="Lấy chi tiết đơn hàng từ DB (Detail_Order.find)" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system4" vertex="1">
          <mxGeometry x="120" y="220" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="build-email-html" value="Xây dựng nội dung HTML email:&lt;div&gt;- Bảng sản phẩm&lt;/div&gt;&lt;div&gt;- Hình ảnh&lt;/div&gt;&lt;div&gt;- Giá và số lượng&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system4" vertex="1">
          <mxGeometry x="110" y="310" width="180" height="80" as="geometry" />
        </mxCell>
        <mxCell id="add-order-info" value="Thêm thông tin:&lt;div&gt;- Mã đơn hàng&lt;/div&gt;&lt;div&gt;- Họ tên, SĐT, địa chỉ&lt;/div&gt;&lt;div&gt;- Phương thức thanh toán&lt;/div&gt;&lt;div&gt;- Phí vận chuyển&lt;/div&gt;&lt;div&gt;- Tổng thanh toán&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system4" vertex="1">
          <mxGeometry x="100" y="420" width="200" height="120" as="geometry" />
        </mxCell>
        <mxCell id="send-email-node" value="Gửi email qua SMTP (mailer.sendMail)&lt;div&gt;Host: smtp.gmail.com&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="swimlane-system4" vertex="1">
          <mxGeometry x="120" y="570" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wKqHdRLLKflESSqN6Z4U-2" value="" style="ellipse;fillColor=strokeColor;html=1;" vertex="1" parent="swimlane-system4">
          <mxGeometry x="185" y="67" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-1" value="" style="endArrow=classic;html=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="swimlane-system4" source="wKqHdRLLKflESSqN6Z4U-2" target="order-confirmed" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="203" y="106" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow4-2" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="order-confirmed" target="get-cart-details" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-3" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="get-cart-details" target="build-email-html" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-4" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;" parent="1" source="build-email-html" target="receive-email-cus" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="470" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow4-5" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="build-email-html" target="add-order-info" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-6" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="add-order-info" target="send-email-node" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-7" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="receive-email-cus" target="view-email" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-8" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="view-email" target="track-via-email" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4-9" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;" parent="1" source="send-email-node" target="track-via-email" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
